{"is_source_file": true, "format": "JavaScript", "description": "This file provides middleware functions for role-based access control in an Express.js application. Specifically, it defines 'checkPermissions' to verify user permissions and 'checkRole' to verify user roles, both used to secure routes by ensuring proper authorization.", "external_files": [], "external_methods": [], "published": ["checkPermissions", "checkRole"], "classes": [], "methods": [{"name": "checkPermissions", "description": "Middleware factory that creates an Express middleware to verify if the user has the required permissions, supporting exact and wildcard permission checks."}, {"name": "checkRole", "description": "Middleware factory that creates an Express middleware to verify if the user has one of the allowed roles."}], "calls": ["req.user", "req.user.permissions", "req.user.role_name", "res.status", "res.json", "next"], "search-terms": ["rbac", "permissions", "roles", "middleware", "express", "authorization", "userPermissions", "checkPermissions", "checkRole"], "state": 2, "file_id": 31, "knowledge_revision": 81, "git_revision": "85b189065008d26a55883aaacacc5cd9e3c4167c", "ctags": [{"_type": "tag", "name": "checkPermissions", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/BackendContainer/src/middleware/rbac.js", "pattern": "/^const checkPermissions = (requiredPermissions) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "checkPermissions", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/BackendContainer/src/middleware/rbac.js", "pattern": "/^module.exports = { checkPermissions, checkRole };$/", "language": "JavaScript", "kind": "field", "scope": "module.exports", "scopeKind": "class"}, {"_type": "tag", "name": "checkRole", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/BackendContainer/src/middleware/rbac.js", "pattern": "/^const checkRole = (allowedRoles) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "hasPermission", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/BackendContainer/src/middleware/rbac.js", "pattern": "/^    const hasPermission = requiredPermissions.some(required => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "userPermissions", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/BackendContainer/src/middleware/rbac.js", "pattern": "/^    const userPermissions = req.user.permissions || [];$/", "language": "JavaScript", "kind": "constant"}], "hash": "640dc8d9f76968114eb5f6f7cf0678f9", "format-version": 4, "code-base-name": "DatabaseContainer", "filename": "BackendContainer/src/middleware/rbac.js", "fields": [{"name": "module.exports = { checkPermissions, checkRole };", "scope": "module.exports", "scopeKind": "class", "description": "unavailable"}], "revision_history": [{"81": "85b189065008d26a55883aaacacc5cd9e3c4167c"}]}