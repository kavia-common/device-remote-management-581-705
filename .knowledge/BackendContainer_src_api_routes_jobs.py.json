{"is_source_file": true, "format": "Python", "description": "This source file defines API routes for managing background jobs in a FastAPI application. It includes endpoints for enqueueing various types of device-related jobs such as SNMP, WebPA, TR-069, and USP GET requests. It also provides a server-sent events endpoint for monitoring job status updates. The code uses SQLAlchemy for database interaction, Celery for task dispatching, and Pydantic models for request validation.", "external_files": ["src/config.py", "src/celery_app.py", "src/db/session.py"], "external_methods": ["get_settings()", "celery_app.send_task()", "get_db_session()"], "published": ["enqueue_snmp_get", "enqueue_webpa_get", "enqueue_tr069_get", "enqueue_usp_get", "job_events"], "classes": [{"name": "EnqueueSNMPGet", "description": "Pydantic model for SNMP GET request payload, including device IP, OID, and credentials."}, {"name": "EnqueueWebPAGet", "description": "Pydantic model for WebPA GET request payload, specifying endpoint and path."}, {"name": "EnqueueTR069Get", "description": "Pydantic model for TR-069 GET request payload, including endpoint and parameter."}, {"name": "EnqueueUSPGet", "description": "Pydantic model for USP GET request payload with endpoint and object path."}], "methods": [{"name": "str _insert_job(tenant_id: Optional[str], user_id: Optional[str], kind: str, params: Dict[str, Any])", "description": "Inserts a new job record into the database with specified tenant, user, kind, and parameters.", "scope": "", "scopeKind": ""}, {"name": "str _enqueue(task_name: str, job_id: str, tenant_id: Optional[str], user_id: Optional[str], kwargs: Dict[str, Any])", "description": "Dispatches a Celery task with RLS context for a specific job.", "scope": "", "scopeKind": ""}, {"name": "Dict[str,Any] enqueue_snmp_get(body: EnqueueSNMPGet, request: Request)", "description": "API endpoint to enqueue an SNMP GET job.", "scope": "", "scopeKind": ""}, {"name": "Dict[str,Any] enqueue_webpa_get(body: EnqueueWebPAGet, request: Request)", "description": "API endpoint to enqueue a WebPA GET job.", "scope": "", "scopeKind": ""}, {"name": "Dict[str,Any] enqueue_tr069_get(body: EnqueueTR069Get, request: Request)", "description": "API endpoint to enqueue a TR-069 GET job.", "scope": "", "scopeKind": ""}, {"name": "Dict[str,Any] enqueue_usp_get(body: EnqueueUSPGet, request: Request)", "description": "API endpoint to enqueue a USP GET job.", "scope": "", "scopeKind": ""}, {"name": "AsyncGenerator[bytes,None] _sse_event_stream(tenant_id: Optional[str], user_id: Optional[str], job_id: str)", "description": "Generator for SSE stream that polls job status and sends updates.", "scope": "", "scopeKind": ""}, {"name": "StreamingResponse job_events(job_id: str, request: Request)", "description": "Endpoint providing server-sent events for job status updates.", "scope": "", "scopeKind": ""}], "calls": ["get_db_session()", "session.execute()", "json.dumps()", "celery_app.send_task()", "_sse_event_stream()", "get_settings()"], "search-terms": ["jobs", "enqueue", "SSE", "server-sent events", "Celery", "FastAPI routes", "job status", "asyncio", "database session", "background tasks"], "state": 2, "file_id": 57, "knowledge_revision": 123, "git_revision": "134a0883211a2332b2cc4a09cf8e0b804144434c", "ctags": [{"_type": "tag", "name": "EnqueueSNMPGet", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/BackendContainer/src/api/routes/jobs.py", "pattern": "/^class EnqueueSNMPGet(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "EnqueueTR069Get", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/BackendContainer/src/api/routes/jobs.py", "pattern": "/^class EnqueueTR069Get(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "EnqueueUSPGet", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/BackendContainer/src/api/routes/jobs.py", "pattern": "/^class EnqueueUSPGet(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "EnqueueWebPAGet", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/BackendContainer/src/api/routes/jobs.py", "pattern": "/^class EnqueueWebPAGet(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "_enqueue", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/BackendContainer/src/api/routes/jobs.py", "pattern": "/^def _enqueue(task_name: str, job_id: str, tenant_id: Optional[str], user_id: Optional[str], kwar/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(task_name: str, job_id: str, tenant_id: Optional[str], user_id: Optional[str], kwargs: Dict[str, Any])"}, {"_type": "tag", "name": "_insert_job", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/BackendContainer/src/api/routes/jobs.py", "pattern": "/^async def _insert_job(tenant_id: Optional[str], user_id: Optional[str], kind: str, params: Dict[/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(tenant_id: Optional[str], user_id: Optional[str], kind: str, params: Dict[str, Any])"}, {"_type": "tag", "name": "_settings", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/BackendContainer/src/api/routes/jobs.py", "pattern": "/^_settings = get_settings()$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "_sse_event_stream", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/BackendContainer/src/api/routes/jobs.py", "pattern": "/^async def _sse_event_stream(tenant_id: Optional[str], user_id: Optional[str], job_id: str) -> As/", "language": "Python", "typeref": "typename:AsyncGenerator[bytes,None]", "kind": "function", "signature": "(tenant_id: Optional[str], user_id: Optional[str], job_id: str)"}, {"_type": "tag", "name": "cred", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/BackendContainer/src/api/routes/jobs.py", "pattern": "/^    cred: Dict[str, Any] = Field(default_factory=dict, description=\"SNMP credential parameters\")$/", "language": "Python", "typeref": "typename:Dict[str, Any]", "kind": "variable", "scope": "EnqueueSNMPGet", "scopeKind": "class"}, {"_type": "tag", "name": "device_ip", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/BackendContainer/src/api/routes/jobs.py", "pattern": "/^    device_ip: str = Field(..., description=\"Target device IP\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "EnqueueSNMPGet", "scopeKind": "class"}, {"_type": "tag", "name": "endpoint", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/BackendContainer/src/api/routes/jobs.py", "pattern": "/^    endpoint: Dict[str, Any] = Field(..., description=\"TR-069 ACS endpoint {base_url,auth}\")$/", "language": "Python", "typeref": "typename:Dict[str, Any]", "kind": "variable", "scope": "EnqueueTR069Get", "scopeKind": "class"}, {"_type": "tag", "name": "endpoint", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/BackendContainer/src/api/routes/jobs.py", "pattern": "/^    endpoint: Dict[str, Any] = Field(..., description=\"USP controller endpoint {base_url,auth}\")$/", "language": "Python", "typeref": "typename:Dict[str, Any]", "kind": "variable", "scope": "EnqueueUSPGet", "scopeKind": "class"}, {"_type": "tag", "name": "endpoint", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/BackendContainer/src/api/routes/jobs.py", "pattern": "/^    endpoint: Dict[str, Any] = Field(..., description=\"WebPA endpoint object {base_url,auth}\")$/", "language": "Python", "typeref": "typename:Dict[str, Any]", "kind": "variable", "scope": "EnqueueWebPAGet", "scopeKind": "class"}, {"_type": "tag", "name": "enqueue_snmp_get", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/BackendContainer/src/api/routes/jobs.py", "pattern": "/^async def enqueue_snmp_get(body: EnqueueSNMPGet, request: Request) -> Dict[str, Any]:$/", "language": "Python", "typeref": "typename:Dict[str,Any]", "kind": "function", "signature": "(body: EnqueueSNMPGet, request: Request)"}, {"_type": "tag", "name": "enqueue_tr069_get", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/BackendContainer/src/api/routes/jobs.py", "pattern": "/^async def enqueue_tr069_get(body: EnqueueTR069Get, request: Request) -> Dict[str, Any]:$/", "language": "Python", "typeref": "typename:Dict[str,Any]", "kind": "function", "signature": "(body: EnqueueTR069Get, request: Request)"}, {"_type": "tag", "name": "enqueue_usp_get", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/BackendContainer/src/api/routes/jobs.py", "pattern": "/^async def enqueue_usp_get(body: EnqueueUSPGet, request: Request) -> Dict[str, Any]:$/", "language": "Python", "typeref": "typename:Dict[str,Any]", "kind": "function", "signature": "(body: EnqueueUSPGet, request: Request)"}, {"_type": "tag", "name": "enqueue_webpa_get", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/BackendContainer/src/api/routes/jobs.py", "pattern": "/^async def enqueue_webpa_get(body: EnqueueWebPAGet, request: Request) -> Dict[str, Any]:$/", "language": "Python", "typeref": "typename:Dict[str,Any]", "kind": "function", "signature": "(body: EnqueueWebPAGet, request: Request)"}, {"_type": "tag", "name": "job_events", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/BackendContainer/src/api/routes/jobs.py", "pattern": "/^async def job_events(job_id: str, request: Request) -> StreamingResponse:$/", "language": "Python", "typeref": "typename:StreamingResponse", "kind": "function", "signature": "(job_id: str, request: Request)"}, {"_type": "tag", "name": "oid", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/BackendContainer/src/api/routes/jobs.py", "pattern": "/^    oid: str = Field(..., description=\"OID to GET\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "EnqueueSNMPGet", "scopeKind": "class"}, {"_type": "tag", "name": "parameter", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/BackendContainer/src/api/routes/jobs.py", "pattern": "/^    parameter: str = Field(..., description=\"Parameter name\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "EnqueueTR069Get", "scopeKind": "class"}, {"_type": "tag", "name": "path", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/BackendContainer/src/api/routes/jobs.py", "pattern": "/^    path: str = Field(..., description=\"Object path\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "EnqueueUSPGet", "scopeKind": "class"}, {"_type": "tag", "name": "path", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/BackendContainer/src/api/routes/jobs.py", "pattern": "/^    path: str = Field(..., description=\"Parameter path\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "EnqueueWebPAGet", "scopeKind": "class"}, {"_type": "tag", "name": "router", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/BackendContainer/src/api/routes/jobs.py", "pattern": "/^router = APIRouter(prefix=\"\\/jobs\", tags=[\"jobs\"])$/", "language": "Python", "kind": "variable"}], "hash": "688f8a5493ace03577df66745c688202", "format-version": 4, "code-base-name": "DatabaseContainer", "filename": "BackendContainer/src/api/routes/jobs.py", "fields": [{"name": "_settings = get_settings()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Dict[str, Any] cred", "scope": "EnqueueSNMPGet", "scopeKind": "class", "description": "unavailable"}, {"name": "str device_ip", "scope": "EnqueueSNMPGet", "scopeKind": "class", "description": "unavailable"}, {"name": "Dict[str, Any] endpoint", "scope": "EnqueueTR069Get", "scopeKind": "class", "description": "unavailable"}, {"name": "str oid", "scope": "EnqueueSNMPGet", "scopeKind": "class", "description": "unavailable"}, {"name": "str parameter", "scope": "EnqueueTR069Get", "scopeKind": "class", "description": "unavailable"}, {"name": "str path", "scope": "EnqueueUSPGet", "scopeKind": "class", "description": "unavailable"}, {"name": "router = APIRouter(prefix=\"\\/jobs\", tags=[\"jobs\"])", "scope": "", "scopeKind": "", "description": "unavailable"}], "revision_history": [{"123": "134a0883211a2332b2cc4a09cf8e0b804144434c"}]}