{"is_source_file": true, "format": "TypeScript", "description": "This file contains utility functions and a class for handling real-time data communication in a React application, specifically implementing server-sent events (SSE) and WebSocket clients for real-time updates.", "external_files": ["react", "react", "localStorage"], "external_methods": ["useEffect", "useRef", "useState"], "published": ["getSSEUrl", "useSSE", "WebSocketClient"], "classes": [{"name": "WebSocketClient", "description": "A class managing WebSocket connections, including reconnection logic, message queuing, and event handling."}], "methods": [{"name": "export function getSSEUrl(path: string): string { getSSEUrl", "description": "Builds a full URL for Server-Sent Events by combining the base API URL with the provided relative path.", "scope": "", "scopeKind": ""}, {"name": "export function useSSE<T = any>(url: string | null, enabled: boolean = true) { useSSE", "description": "React hook that establishes an SSE connection, managing incoming data, connection status, and errors.", "scope": "", "scopeKind": ""}, {"name": "WebSocketClient", "description": "A class for creating a WebSocket client with automatic reconnection, message queuing, and callback registration."}], "calls": ["useEffect", "localStorage.getItem", "EventSource", "JSON.parse", "console.error", "console.log", "WebSocket", "setTimeout"], "search-terms": ["realtime", "WebSocket", "SSE", "useSSE", "WebSocketClient", "react", "utils", "realtime.ts"], "state": 2, "file_id": 36, "knowledge_revision": 180, "git_revision": "be4492d7a5c565b42d01595db152d8b53f8224b1", "revision_history": [{"75": "6590bfa06afc3693b6cdd76a1680213beba9d0d9"}, {"180": "be4492d7a5c565b42d01595db152d8b53f8224b1"}], "ctags": [{"_type": "tag", "name": "WebSocketClient", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/FrontendContainer/src/utils/realtime.ts", "pattern": "/^export class WebSocketClient {$/", "language": "TypeScript", "kind": "class"}, {"_type": "tag", "name": "base", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/FrontendContainer/src/utils/realtime.ts", "pattern": "/^  const base = import.meta.env.VITE_API_BASE_URL?.replace(\\/\\\\\\/+$\\/, '') ?? '';$/", "language": "TypeScript", "kind": "constant", "scope": "getSSEUrl", "scopeKind": "function"}, {"_type": "tag", "name": "data", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/FrontendContainer/src/utils/realtime.ts", "pattern": "/^        const data = JSON.parse(event.data);$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "data", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/FrontendContainer/src/utils/realtime.ts", "pattern": "/^    const message = typeof data === 'string' ? data : JSON.stringify(data);$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "data", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/FrontendContainer/src/utils/realtime.ts", "pattern": "/^  const [data, setData] = useState<T | null>(null);$/", "language": "TypeScript", "kind": "constant", "scope": "useSSE", "scopeKind": "function"}, {"_type": "tag", "name": "error", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/FrontendContainer/src/utils/realtime.ts", "pattern": "/^  const [error, setError] = useState<Error | null>(null);$/", "language": "TypeScript", "kind": "constant", "scope": "useSSE", "scopeKind": "function"}, {"_type": "tag", "name": "eventSource", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/FrontendContainer/src/utils/realtime.ts", "pattern": "/^    const eventSource = new EventSource(urlWithToken);$/", "language": "TypeScript", "kind": "constant", "scope": "useSSE", "scopeKind": "function"}, {"_type": "tag", "name": "eventSourceRef", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/FrontendContainer/src/utils/realtime.ts", "pattern": "/^  const eventSourceRef = useRef<EventSource | null>(null);$/", "language": "TypeScript", "kind": "constant", "scope": "useSSE", "scopeKind": "function"}, {"_type": "tag", "name": "getSSEUrl", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/FrontendContainer/src/utils/realtime.ts", "pattern": "/^export function getSSEUrl(path: string): string {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "isConnected", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/FrontendContainer/src/utils/realtime.ts", "pattern": "/^  const [isConnected, setIsConnected] = useState(false);$/", "language": "TypeScript", "kind": "constant", "scope": "useSSE", "scopeKind": "function"}, {"_type": "tag", "name": "maxReconnectAttempts", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/FrontendContainer/src/utils/realtime.ts", "pattern": "/^  private maxReconnectAttempts = 5;$/", "language": "TypeScript", "kind": "property", "scope": "WebSocketClient", "scopeKind": "class"}, {"_type": "tag", "name": "message", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/FrontendContainer/src/utils/realtime.ts", "pattern": "/^    const message = typeof data === 'string' ? data : JSON.stringify(data);$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "messageQueue", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/FrontendContainer/src/utils/realtime.ts", "pattern": "/^  private messageQueue: string[] = [];$/", "language": "TypeScript", "kind": "property", "scope": "WebSocketClient", "scopeKind": "class"}, {"_type": "tag", "name": "msg", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/FrontendContainer/src/utils/realtime.ts", "pattern": "/^        const msg = this.messageQueue.shift();$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "parsed", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/FrontendContainer/src/utils/realtime.ts", "pattern": "/^        const parsed = JSON.parse(event.data);$/", "language": "TypeScript", "kind": "constant", "scope": "useSSE", "scopeKind": "function"}, {"_type": "tag", "name": "reconnectAttempts", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/FrontendContainer/src/utils/realtime.ts", "pattern": "/^  private reconnectAttempts = 0;$/", "language": "TypeScript", "kind": "property", "scope": "WebSocketClient", "scopeKind": "class"}, {"_type": "tag", "name": "reconnectDelay", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/FrontendContainer/src/utils/realtime.ts", "pattern": "/^  private reconnectDelay = 1000;$/", "language": "TypeScript", "kind": "property", "scope": "WebSocketClient", "scopeKind": "class"}, {"_type": "tag", "name": "setData", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/FrontendContainer/src/utils/realtime.ts", "pattern": "/^  const [data, setData] = useState<T | null>(null);$/", "language": "TypeScript", "kind": "constant", "scope": "useSSE", "scopeKind": "function"}, {"_type": "tag", "name": "setError", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/FrontendContainer/src/utils/realtime.ts", "pattern": "/^  const [error, setError] = useState<Error | null>(null);$/", "language": "TypeScript", "kind": "constant", "scope": "useSSE", "scopeKind": "function"}, {"_type": "tag", "name": "setIsConnected", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/FrontendContainer/src/utils/realtime.ts", "pattern": "/^  const [isConnected, setIsConnected] = useState(false);$/", "language": "TypeScript", "kind": "constant", "scope": "useSSE", "scopeKind": "function"}, {"_type": "tag", "name": "token", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/FrontendContainer/src/utils/realtime.ts", "pattern": "/^    const token = localStorage.getItem('auth_token');$/", "language": "TypeScript", "kind": "constant", "scope": "useSSE", "scopeKind": "function"}, {"_type": "tag", "name": "token", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/FrontendContainer/src/utils/realtime.ts", "pattern": "/^    const token = localStorage.getItem('auth_token');$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "url", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/FrontendContainer/src/utils/realtime.ts", "pattern": "/^  private url: string;$/", "language": "TypeScript", "kind": "property", "scope": "WebSocketClient", "scopeKind": "class"}, {"_type": "tag", "name": "urlWithToken", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/FrontendContainer/src/utils/realtime.ts", "pattern": "/^    const urlWithToken = token ? `${this.url}?token=${token}` : this.url;$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "urlWithToken", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/FrontendContainer/src/utils/realtime.ts", "pattern": "/^    const urlWithToken = token ? `${url}?token=${token}` : url;$/", "language": "TypeScript", "kind": "constant", "scope": "useSSE", "scopeKind": "function"}, {"_type": "tag", "name": "useSSE", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/FrontendContainer/src/utils/realtime.ts", "pattern": "/^export function useSSE<T = any>(url: string | null, enabled: boolean = true) {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "ws", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/FrontendContainer/src/utils/realtime.ts", "pattern": "/^  private ws: WebSocket | null = null;$/", "language": "TypeScript", "kind": "property", "scope": "WebSocketClient", "scopeKind": "class"}], "hash": "01ca801a2e3331bc0f041a748a3b40a0", "format-version": 4, "code-base-name": "DatabaseContainer", "filename": "FrontendContainer/src/utils/realtime.ts", "fields": [{"name": "private maxReconnectAttempts = 5;", "scope": "WebSocketClient", "scopeKind": "class", "description": "unavailable"}, {"name": "private messageQueue: string[] = [];", "scope": "WebSocketClient", "scopeKind": "class", "description": "unavailable"}, {"name": "private reconnectAttempts = 0;", "scope": "WebSocketClient", "scopeKind": "class", "description": "unavailable"}, {"name": "private reconnectDelay = 1000;", "scope": "WebSocketClient", "scopeKind": "class", "description": "unavailable"}, {"name": "private url: string;", "scope": "WebSocketClient", "scopeKind": "class", "description": "unavailable"}, {"name": "private ws: WebSocket | null = null;", "scope": "WebSocketClient", "scopeKind": "class", "description": "unavailable"}]}