{"is_source_file": true, "format": "Python", "description": "This file implements an asynchronous USP (User Services Platform / TR-369) client supporting various transport modes (HTTP, MQTT, WebSocket). It provides functionality to perform GET, SET, and OPERATE commands on USP data models via a REST API primarily, with placeholders for MQTT and WebSocket extensions. It includes configuration classes, error handling, and a factory function for client creation.", "external_files": ["httpx"], "external_methods": ["httpx.AsyncClient", "httpx.BasicAuth"], "published": ["create_usp_client"], "classes": [{"name": "USPTransportMode", "description": "Enum defining the supported USP transport modes: MQTT, WebSocket, HTTP."}, {"name": "USPConfig", "description": "Dataclass encapsulating configuration parameters for the USP client, including authentication and mode-specific options."}, {"name": "USPClientError", "description": "Base class for exceptions raised by the USP client."}, {"name": "USPTimeoutError", "description": "Exception indicating a timeout during USP operations."}, {"name": "USPAuthError", "description": "Exception indicating an authentication failure in USP operations."}, {"name": "USPClient", "description": "Asynchronous client implementing USP protocol interactions over different transport modes, with methods to get, set, operate, and close connections."}], "methods": [{"name": "USPClient create_usp_client(base_url: str, auth: Dict[str, Any])", "description": "Factory function to create and configure a USPClient instance based on provided URL and authentication parameters.", "scope": "", "scopeKind": ""}, {"name": "__init__(self, config: USPConfig)", "scope": "USPClient", "scopeKind": "class", "description": "unavailable"}, {"name": "httpx.AsyncClient _get_client(self)", "scope": "USPClient", "scopeKind": "class", "description": "unavailable"}, {"name": "Dict[str,Any] _http_get(self, device_id: str, path: str)", "scope": "USPClient", "scopeKind": "class", "description": "unavailable"}, {"name": "Dict[str,Any] _http_set(self, device_id: str, path: str, value: Any)", "scope": "USPClient", "scopeKind": "class", "description": "unavailable"}, {"name": "Dict[str,Any] _mqtt_get(self, device_id: str, path: str)", "scope": "USPClient", "scopeKind": "class", "description": "unavailable"}, {"name": "Dict[str,Any] _mqtt_set(self, device_id: str, path: str, value: Any)", "scope": "USPClient", "scopeKind": "class", "description": "unavailable"}, {"name": "Dict[str,Any] _ws_get(self, device_id: str, path: str)", "scope": "USPClient", "scopeKind": "class", "description": "unavailable"}, {"name": "Dict[str,Any] _ws_set(self, device_id: str, path: str, value: Any)", "scope": "USPClient", "scopeKind": "class", "description": "unavailable"}, {"name": "None close(self)", "scope": "USPClient", "scopeKind": "class", "description": "unavailable"}, {"name": "Dict[str,Any] get(self, device_id: str, path: str)", "scope": "USPClient", "scopeKind": "class", "description": "unavailable"}, {"name": "Dict[str,Any] operate(self, device_id: str, command: str, args: Optional[Dict[str, Any]] = None)", "scope": "USPClient", "scopeKind": "class", "description": "unavailable"}, {"name": "Dict[str,Any] set(self, device_id: str, path: str, value: Any)", "scope": "USPClient", "scopeKind": "class", "description": "unavailable"}], "calls": ["httpx.AsyncClient", "httpx.BasicAuth"], "search-terms": ["USPClient", "WebSocket", "MQTT", "get", "set", "operate", "authentication", "REST API", "TR-369"], "state": 2, "file_id": 79, "knowledge_revision": 176, "git_revision": "cb1725278595076f89bdff718c235dd382b960a2", "ctags": [{"_type": "tag", "name": "HTTP", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/BackendContainer/src/protocols/usp_client.py", "pattern": "/^    HTTP = \"http\"  # For controller REST API wrapper$/", "language": "Python", "kind": "variable", "scope": "USPTransportMode", "scopeKind": "class"}, {"_type": "tag", "name": "MQTT", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/BackendContainer/src/protocols/usp_client.py", "pattern": "/^    MQTT = \"mqtt\"$/", "language": "Python", "kind": "variable", "scope": "USPTransportMode", "scopeKind": "class"}, {"_type": "tag", "name": "USPAuthError", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/BackendContainer/src/protocols/usp_client.py", "pattern": "/^class USPAuthError(USPClientError):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "USPClient", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/BackendContainer/src/protocols/usp_client.py", "pattern": "/^class USPClient:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "USPClientError", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/BackendContainer/src/protocols/usp_client.py", "pattern": "/^class USPClientError(Exception):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "USPConfig", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/BackendContainer/src/protocols/usp_client.py", "pattern": "/^class USPConfig:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "USPTimeoutError", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/BackendContainer/src/protocols/usp_client.py", "pattern": "/^class USPTimeoutError(USPClientError):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "USPTransportMode", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/BackendContainer/src/protocols/usp_client.py", "pattern": "/^class USPTransportMode(Enum):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "WEBSOCKET", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/BackendContainer/src/protocols/usp_client.py", "pattern": "/^    WEBSOCKET = \"websocket\"$/", "language": "Python", "kind": "variable", "scope": "USPTransportMode", "scopeKind": "class"}, {"_type": "tag", "name": "__init__", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/BackendContainer/src/protocols/usp_client.py", "pattern": "/^    def __init__(self, config: USPConfig):$/", "language": "Python", "kind": "member", "signature": "(self, config: USPConfig)", "scope": "USPClient", "scopeKind": "class"}, {"_type": "tag", "name": "_get_client", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/BackendContainer/src/protocols/usp_client.py", "pattern": "/^    async def _get_client(self) -> httpx.AsyncClient:$/", "language": "Python", "typeref": "typename:httpx.AsyncClient", "kind": "member", "signature": "(self)", "scope": "USPClient", "scopeKind": "class"}, {"_type": "tag", "name": "_http_get", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/BackendContainer/src/protocols/usp_client.py", "pattern": "/^    async def _http_get(self, device_id: str, path: str) -> Dict[str, Any]:$/", "language": "Python", "typeref": "typename:Dict[str,Any]", "kind": "member", "signature": "(self, device_id: str, path: str)", "scope": "USPClient", "scopeKind": "class"}, {"_type": "tag", "name": "_http_set", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/BackendContainer/src/protocols/usp_client.py", "pattern": "/^    async def _http_set(self, device_id: str, path: str, value: Any) -> Dict[str, Any]:$/", "language": "Python", "typeref": "typename:Dict[str,Any]", "kind": "member", "signature": "(self, device_id: str, path: str, value: Any)", "scope": "USPClient", "scopeKind": "class"}, {"_type": "tag", "name": "_mqtt_get", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/BackendContainer/src/protocols/usp_client.py", "pattern": "/^    async def _mqtt_get(self, device_id: str, path: str) -> Dict[str, Any]:$/", "language": "Python", "typeref": "typename:Dict[str,Any]", "kind": "member", "signature": "(self, device_id: str, path: str)", "scope": "USPClient", "scopeKind": "class"}, {"_type": "tag", "name": "_mqtt_set", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/BackendContainer/src/protocols/usp_client.py", "pattern": "/^    async def _mqtt_set(self, device_id: str, path: str, value: Any) -> Dict[str, Any]:$/", "language": "Python", "typeref": "typename:Dict[str,Any]", "kind": "member", "signature": "(self, device_id: str, path: str, value: Any)", "scope": "USPClient", "scopeKind": "class"}, {"_type": "tag", "name": "_ws_get", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/BackendContainer/src/protocols/usp_client.py", "pattern": "/^    async def _ws_get(self, device_id: str, path: str) -> Dict[str, Any]:$/", "language": "Python", "typeref": "typename:Dict[str,Any]", "kind": "member", "signature": "(self, device_id: str, path: str)", "scope": "USPClient", "scopeKind": "class"}, {"_type": "tag", "name": "_ws_set", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/BackendContainer/src/protocols/usp_client.py", "pattern": "/^    async def _ws_set(self, device_id: str, path: str, value: Any) -> Dict[str, Any]:$/", "language": "Python", "typeref": "typename:Dict[str,Any]", "kind": "member", "signature": "(self, device_id: str, path: str, value: Any)", "scope": "USPClient", "scopeKind": "class"}, {"_type": "tag", "name": "api_key", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/BackendContainer/src/protocols/usp_client.py", "pattern": "/^    api_key: Optional[str] = None$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "USPConfig", "scopeKind": "class"}, {"_type": "tag", "name": "api_key_header", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/BackendContainer/src/protocols/usp_client.py", "pattern": "/^    api_key_header: str = \"X-API-Key\"$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "USPConfig", "scopeKind": "class"}, {"_type": "tag", "name": "auth_type", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/BackendContainer/src/protocols/usp_client.py", "pattern": "/^    auth_type: str = \"none\"  # \"none\", \"basic\", \"bearer\", \"apikey\"$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "USPConfig", "scopeKind": "class"}, {"_type": "tag", "name": "close", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/BackendContainer/src/protocols/usp_client.py", "pattern": "/^    async def close(self) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "member", "signature": "(self)", "scope": "USPClient", "scopeKind": "class"}, {"_type": "tag", "name": "create_usp_client", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/BackendContainer/src/protocols/usp_client.py", "pattern": "/^def create_usp_client(base_url: str, auth: Dict[str, Any]) -> USPClient:$/", "language": "Python", "typeref": "typename:USPClient", "kind": "function", "signature": "(base_url: str, auth: Dict[str, Any])"}, {"_type": "tag", "name": "get", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/BackendContainer/src/protocols/usp_client.py", "pattern": "/^    async def get(self, device_id: str, path: str) -> Dict[str, Any]:$/", "language": "Python", "typeref": "typename:Dict[str,Any]", "kind": "member", "signature": "(self, device_id: str, path: str)", "scope": "USPClient", "scopeKind": "class"}, {"_type": "tag", "name": "mode", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/BackendContainer/src/protocols/usp_client.py", "pattern": "/^    mode: USPTransportMode = USPTransportMode.HTTP$/", "language": "Python", "typeref": "typename:USPTransportMode", "kind": "variable", "scope": "USPConfig", "scopeKind": "class"}, {"_type": "tag", "name": "mqtt_broker", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/BackendContainer/src/protocols/usp_client.py", "pattern": "/^    mqtt_broker: Optional[str] = None$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "USPConfig", "scopeKind": "class"}, {"_type": "tag", "name": "mqtt_port", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/BackendContainer/src/protocols/usp_client.py", "pattern": "/^    mqtt_port: int = 1883$/", "language": "Python", "typeref": "typename:int", "kind": "variable", "scope": "USPConfig", "scopeKind": "class"}, {"_type": "tag", "name": "mqtt_topic_prefix", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/BackendContainer/src/protocols/usp_client.py", "pattern": "/^    mqtt_topic_prefix: str = \"usp\\/\"$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "USPConfig", "scopeKind": "class"}, {"_type": "tag", "name": "operate", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/BackendContainer/src/protocols/usp_client.py", "pattern": "/^    async def operate(self, device_id: str, command: str, args: Optional[Dict[str, Any]] = None)/", "language": "Python", "typeref": "typename:Dict[str,Any]", "kind": "member", "signature": "(self, device_id: str, command: str, args: Optional[Dict[str, Any]] = None)", "scope": "USPClient", "scopeKind": "class"}, {"_type": "tag", "name": "password", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/BackendContainer/src/protocols/usp_client.py", "pattern": "/^    password: Optional[str] = None$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "USPConfig", "scopeKind": "class"}, {"_type": "tag", "name": "retries", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/BackendContainer/src/protocols/usp_client.py", "pattern": "/^    retries: int = 3$/", "language": "Python", "typeref": "typename:int", "kind": "variable", "scope": "USPConfig", "scopeKind": "class"}, {"_type": "tag", "name": "set", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/BackendContainer/src/protocols/usp_client.py", "pattern": "/^    async def set(self, device_id: str, path: str, value: Any) -> Dict[str, Any]:$/", "language": "Python", "typeref": "typename:Dict[str,Any]", "kind": "member", "signature": "(self, device_id: str, path: str, value: Any)", "scope": "USPClient", "scopeKind": "class"}, {"_type": "tag", "name": "timeout", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/BackendContainer/src/protocols/usp_client.py", "pattern": "/^    timeout: float = 30.0$/", "language": "Python", "typeref": "typename:float", "kind": "variable", "scope": "USPConfig", "scopeKind": "class"}, {"_type": "tag", "name": "token", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/BackendContainer/src/protocols/usp_client.py", "pattern": "/^    token: Optional[str] = None$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "USPConfig", "scopeKind": "class"}, {"_type": "tag", "name": "username", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/BackendContainer/src/protocols/usp_client.py", "pattern": "/^    username: Optional[str] = None$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "USPConfig", "scopeKind": "class"}, {"_type": "tag", "name": "ws_endpoint", "path": "/home/kavia/workspace/code-generation/device-remote-management-581-705/BackendContainer/src/protocols/usp_client.py", "pattern": "/^    ws_endpoint: Optional[str] = None$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "USPConfig", "scopeKind": "class"}], "hash": "3901ecc9006590b181f99cac8c142ab2", "format-version": 4, "code-base-name": "DatabaseContainer", "filename": "BackendContainer/src/protocols/usp_client.py", "fields": [{"name": "HTTP = \"http\"  # For controller REST API wrapper", "scope": "USPTransportMode", "scopeKind": "class", "description": "unavailable"}, {"name": "MQTT = \"mqtt\"", "scope": "USPTransportMode", "scopeKind": "class", "description": "unavailable"}, {"name": "WEBSOCKET = \"websocket\"", "scope": "USPTransportMode", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[str] api_key", "scope": "USPConfig", "scopeKind": "class", "description": "unavailable"}, {"name": "str api_key_header", "scope": "USPConfig", "scopeKind": "class", "description": "unavailable"}, {"name": "str auth_type", "scope": "USPConfig", "scopeKind": "class", "description": "unavailable"}, {"name": "USPTransportMode mode", "scope": "USPConfig", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[str] mqtt_broker", "scope": "USPConfig", "scopeKind": "class", "description": "unavailable"}, {"name": "int mqtt_port", "scope": "USPConfig", "scopeKind": "class", "description": "unavailable"}, {"name": "str mqtt_topic_prefix", "scope": "USPConfig", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[str] password", "scope": "USPConfig", "scopeKind": "class", "description": "unavailable"}, {"name": "int retries", "scope": "USPConfig", "scopeKind": "class", "description": "unavailable"}, {"name": "float timeout", "scope": "USPConfig", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[str] token", "scope": "USPConfig", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[str] username", "scope": "USPConfig", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[str] ws_endpoint", "scope": "USPConfig", "scopeKind": "class", "description": "unavailable"}], "revision_history": [{"176": "cb1725278595076f89bdff718c235dd382b960a2"}]}